import{a as m,I as ke,_ as _e,t as g,c as J,K as F,G as Oe,J as P,L as me,M as he,N as Be,g as Ae,m as Ke,r as We,u as qe,C as Ge,O as Xe,T as Ye,d as R,j as t,F as Y,P as Q,b as U,k as Je,B as E,l as Qe,n as Ue,o as ge,p as Ze,q as et,Q as L,U as tt,V as at,W as rt,X as Ce,Y as X,Z as pe,$ as st,a0 as nt,a1 as ot,w as lt,H as it}from"./index-CnTpDji2.js";var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"},dt=function(a,s){return m.createElement(ke,_e({},a,{ref:s,icon:ct}))},ut=m.forwardRef(dt);function ft(e,a){var s=e.disabled,r=e.prefixCls,n=e.character,c=e.characterRender,l=e.index,d=e.count,i=e.value,u=e.allowHalf,y=e.focused,N=e.onHover,$=e.onClick,C=function(x){N(x,l)},H=function(x){$(x,l)},D=function(x){x.keyCode===F.ENTER&&$(x,l)},w=l+1,p=new Set([r]);i===0&&l===0&&y?p.add("".concat(r,"-focused")):u&&i+.5>=w&&i<w?(p.add("".concat(r,"-half")),p.add("".concat(r,"-active")),y&&p.add("".concat(r,"-focused"))):(w<=i?p.add("".concat(r,"-full")):p.add("".concat(r,"-zero")),w===i&&y&&p.add("".concat(r,"-focused")));var f=typeof n=="function"?n(e):n,z=g.createElement("li",{className:J(Array.from(p)),ref:a},g.createElement("div",{onClick:s?null:H,onKeyDown:s?null:D,onMouseMove:s?null:C,role:"radio","aria-checked":i>l?"true":"false","aria-posinset":l+1,"aria-setsize":d,tabIndex:s?-1:0},g.createElement("div",{className:"".concat(r,"-first")},f),g.createElement("div",{className:"".concat(r,"-second")},f)));return c&&(z=c(z,e)),z}const vt=g.forwardRef(ft);function mt(){var e=m.useRef({});function a(r){return e.current[r]}function s(r){return function(n){e.current[r]=n}}return[a,s]}function ht(e){var a=e.pageXOffset,s="scrollLeft";if(typeof a!="number"){var r=e.document;a=r.documentElement[s],typeof a!="number"&&(a=r.body[s])}return a}function gt(e){var a,s,r=e.ownerDocument,n=r.body,c=r&&r.documentElement,l=e.getBoundingClientRect();return a=l.left,s=l.top,a-=c.clientLeft||n.clientLeft||0,s-=c.clientTop||n.clientTop||0,{left:a,top:s}}function pt(e){var a=gt(e),s=e.ownerDocument,r=s.defaultView||s.parentWindow;return a.left+=ht(r),a.left}var xt=["prefixCls","className","defaultValue","value","count","allowHalf","allowClear","keyboard","character","characterRender","disabled","direction","tabIndex","autoFocus","onHoverChange","onChange","onFocus","onBlur","onKeyDown","onMouseLeave"];function _t(e,a){var s=e.prefixCls,r=s===void 0?"rc-rate":s,n=e.className,c=e.defaultValue,l=e.value,d=e.count,i=d===void 0?5:d,u=e.allowHalf,y=u===void 0?!1:u,N=e.allowClear,$=N===void 0?!0:N,C=e.keyboard,H=C===void 0?!0:C,D=e.character,w=D===void 0?"★":D,p=e.characterRender,f=e.disabled,z=e.direction,I=z===void 0?"ltr":z,x=e.tabIndex,V=x===void 0?0:x,k=e.autoFocus,M=e.onHoverChange,O=e.onChange,B=e.onFocus,A=e.onBlur,K=e.onKeyDown,W=e.onMouseLeave,be=Oe(e,xt),Se=mt(),ee=P(Se,2),ye=ee[0],we=ee[1],q=g.useRef(null),te=function(){if(!f){var o;(o=q.current)===null||o===void 0||o.focus()}};g.useImperativeHandle(a,function(){return{focus:te,blur:function(){if(!f){var o;(o=q.current)===null||o===void 0||o.blur()}}}});var ze=me(c||0,{value:l}),ae=P(ze,2),S=ae[0],Ie=ae[1],Re=me(null),re=P(Re,2),Ne=re[0],G=re[1],se=function(o,b){var v=I==="rtl",_=o+1;if(y){var ue=ye(o),fe=pt(ue),ve=ue.clientWidth;(v&&b-fe>ve/2||!v&&b-fe<ve/2)&&(_-=.5)}return _},T=function(o){Ie(o),O==null||O(o)},$e=g.useState(!1),ne=P($e,2),He=ne[0],oe=ne[1],De=function(){oe(!0),B==null||B()},Me=function(){oe(!1),A==null||A()},Te=g.useState(null),le=P(Te,2),ie=le[0],ce=le[1],Pe=function(o,b){var v=se(b,o.pageX);v!==Ne&&(ce(v),G(null)),M==null||M(v)},de=function(o){f||(ce(null),G(null),M==null||M(void 0)),o&&(W==null||W(o))},Fe=function(o,b){var v=se(b,o.pageX),_=!1;$&&(_=v===S),de(),T(_?0:v),G(_?v:null)},Ee=function(o){var b=o.keyCode,v=I==="rtl",_=y?.5:1;H&&(b===F.RIGHT&&S<i&&!v?(T(S+_),o.preventDefault()):b===F.LEFT&&S>0&&!v||b===F.RIGHT&&S>0&&v?(T(S-_),o.preventDefault()):b===F.LEFT&&S<i&&v&&(T(S+_),o.preventDefault())),K==null||K(o)};g.useEffect(function(){k&&!f&&te()},[]);var Le=new Array(i).fill(0).map(function(j,o){return g.createElement(vt,{ref:we(o),index:o,count:i,disabled:f,prefixCls:"".concat(r,"-star"),allowHalf:y,value:ie===null?S:ie,onClick:Fe,onHover:Pe,key:j||o,character:w,characterRender:p,focused:He})}),Ve=J(r,n,he(he({},"".concat(r,"-disabled"),f),"".concat(r,"-rtl"),I==="rtl"));return g.createElement("ul",_e({className:Ve,onMouseLeave:de,tabIndex:f?-1:V,onFocus:f?null:De,onBlur:f?null:Me,onKeyDown:f?null:Ee,ref:q,role:"radiogroup"},Be(be,{aria:!0,data:!0,attr:!0})),Le)}const Ct=g.forwardRef(_t),jt=e=>{const{componentCls:a}=e;return{[`${a}-star`]:{position:"relative",display:"inline-block",color:"inherit",cursor:"pointer","&:not(:last-child)":{marginInlineEnd:e.marginXS},"> div":{transition:`all ${e.motionDurationMid}, outline 0s`,"&:hover":{transform:e.starHoverScale},"&:focus":{outline:0},"&:focus-visible":{outline:`${qe(e.lineWidth)} dashed ${e.starColor}`,transform:e.starHoverScale}},"&-first, &-second":{color:e.starBg,transition:`all ${e.motionDurationMid}`,userSelect:"none"},"&-first":{position:"absolute",top:0,insetInlineStart:0,width:"50%",height:"100%",overflow:"hidden",opacity:0},[`&-half ${a}-star-first, &-half ${a}-star-second`]:{opacity:1},[`&-half ${a}-star-first, &-full ${a}-star-second`]:{color:"inherit"}}}},bt=e=>({[`&-rtl${e.componentCls}`]:{direction:"rtl"}}),St=e=>{const{componentCls:a}=e;return{[a]:Object.assign(Object.assign(Object.assign(Object.assign({},We(e)),{display:"inline-block",margin:0,padding:0,color:e.starColor,fontSize:e.starSize,lineHeight:1,listStyle:"none",outline:"none",[`&-disabled${a} ${a}-star`]:{cursor:"default","> div:hover":{transform:"scale(1)"}}}),jt(e)),bt(e))}},yt=e=>({starColor:e.yellow6,starSize:e.controlHeightLG*.5,starHoverScale:"scale(1.1)",starBg:e.colorFillContent}),wt=Ae("Rate",e=>{const a=Ke(e,{});return[St(a)]},yt);var zt=function(e,a){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&a.indexOf(r)<0&&(s[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)a.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(s[r[n]]=e[r[n]]);return s};const Z=m.forwardRef((e,a)=>{const{prefixCls:s,className:r,rootClassName:n,style:c,tooltips:l,character:d=m.createElement(ut,null),disabled:i}=e,u=zt(e,["prefixCls","className","rootClassName","style","tooltips","character","disabled"]),y=(x,V)=>{let{index:k}=V;return l?m.createElement(Ye,{title:l[k]},x):x},{getPrefixCls:N,direction:$,rate:C}=m.useContext(Ge),H=N("rate",s),[D,w,p]=wt(H),f=Object.assign(Object.assign({},C==null?void 0:C.style),c),z=m.useContext(Xe),I=i??z;return D(m.createElement(Ct,Object.assign({ref:a,character:d,characterRender:y,disabled:I},u,{className:J(r,n,w,p,C==null?void 0:C.className),style:f,prefixCls:H,direction:$})))}),It="_pizzaCard_ti28m_1",Rt="_pizzaCard__image_ti28m_14",Nt="_pizzaCard__details_ti28m_26",$t="_pizzaTitle_ti28m_35",Ht="_pizzaDescription_ti28m_41",Dt="_sizeSelector_ti28m_47",Mt="_crustSelector_ti28m_48",Tt="_active_ti28m_64",Pt="_ingredients_ti28m_70",Ft="_ingredient_ti28m_70",Et="_addToCart_ti28m_83",h={pizzaCard:It,pizzaCard__image:Rt,pizzaCard__details:Nt,pizzaTitle:$t,pizzaDescription:Ht,sizeSelector:Dt,crustSelector:Mt,active:Tt,ingredients:Pt,ingredient:Ft,addToCart:Et},Lt=()=>{const{product:e}=R(a=>a.product);return t.jsx("img",{src:e.image?e.image:e.iiko_image,width:"100%",style:{borderRadius:"30px"},alt:"Пепперони фреш",className:h.pizzaImage})},Vt=()=>{var a;const{product:e}=R(s=>s.product);return t.jsx("div",{className:h.crustSelector,children:t.jsxs(Y,{gap:16,children:[t.jsx(Z,{value:e.average_rating}),t.jsxs("p",{children:["Количество отзывов ",(a=e==null?void 0:e.product_reviews)==null?void 0:a.length]})]})})},kt=()=>{const{product:e}=R(a=>a.product);return t.jsxs("div",{className:h.ingredients,children:[t.jsx("h3",{children:"Пишевая ценность"}),t.jsxs("div",{className:h.ingredientsList,children:[t.jsxs("div",{className:h.ingredient,children:[t.jsx("span",{children:"Жиры"}),t.jsx("span",{children:e.fats})]}),t.jsxs("div",{className:h.ingredient,children:[t.jsx("span",{children:"Белки"}),t.jsx("span",{children:e.proteins})]}),t.jsxs("div",{className:h.ingredient,children:[t.jsx("span",{children:"Углеводы"}),t.jsx("span",{children:e.carbs})]}),t.jsxs("div",{className:h.ingredient,children:[t.jsx("span",{children:"Ккал"}),t.jsx("span",{children:e.energy})]}),t.jsxs("div",{className:h.ingredient,children:[t.jsx("span",{children:"Граммы"}),t.jsx("span",{children:e.portionWeightGrams})]})]})]})},Ot=({price:e})=>{const{id:a}=Q(),s=U();function r(){const d={quantity:1,total:+e,cart:Number(localStorage.getItem("cart_id")),product:Number(a)};s(Ue({data:d})).then(()=>ge.success(`Товар ${name} успешно добвлен `))}const{data:n}=R(d=>d.cart),c=n.items.find(d=>d.product.id===Number(a));async function l(d){try{await Ze.deleteCartItemById(d).then(()=>{s(et(d)),ge.success("товар успешно удален из корзины")})}catch(i){console.log(i)}}return t.jsx(Y,{gap:5,justify:"space-between",align:"center",children:c?t.jsxs(Y,{children:[t.jsx(Je,{record:c}),t.jsx(E,{onClick:()=>l(c.id),danger:!0,style:{width:"32px",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:"5px"},icon:t.jsx(Qe,{style:{color:"red"}})})]}):t.jsx(E,{className:"select-button",onClick:r,type:"primary",children:"Добавить в корзину"})})},Bt=()=>{const{product:e}=R(a=>a.product);return t.jsxs("div",{className:h.pizzaCard,children:[t.jsx("div",{className:h.pizzaCard__image,children:t.jsx(Lt,{})}),t.jsxs("div",{className:h.pizzaCard__details,children:[t.jsx("h1",{className:h.pizzaTitle,children:e.title}),t.jsx("p",{className:h.pizzaDescription,children:e.description}),t.jsx(Vt,{}),t.jsx(kt,{}),t.jsx(Ot,{price:e.price})]})]})},At="_form_hqwtq_1",xe={form:At},Kt=()=>{const[e]=L.useForm(),[a,s]=m.useState(0),{id:r}=Q(),n=U(),c=l=>{console.log("Success:",l),n(rt({data:{text:l.text,stars:a,user:localStorage.getItem("user_id"),product:Number(r)}})).then(()=>{n(Ce({id:Number(r)}))})};return t.jsx(tt,{className:xe.form,children:t.jsxs(L,{name:"basic",form:e,onFinish:c,autoComplete:"off",children:[t.jsx(Z,{onChange:s,value:a}),t.jsx("p",{children:"Оцените товар:"}),t.jsx(L.Item,{name:"text",rules:[{required:!0,message:"Please input your password!"}],children:t.jsx(at,{style:{padding:"10px"},placeholder:"Отзыв"})}),t.jsx(L.Item,{colon:!1,children:t.jsx(E,{className:xe.button,type:"primary",htmlType:"submit",block:!0,children:"Submit"})})]})})},je=e=>{const a=new Date(e),s=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),n=String(a.getDate()).padStart(2,"0"),c=String(a.getHours()).padStart(2,"0"),l=String(a.getMinutes()).padStart(2,"0"),d=String(a.getSeconds()).padStart(2,"0");return`${s}-${r}-${n} ${c}:${l}:${d}`},Wt="2024-09-11T11:20:46.804805+06:00";console.log(je(Wt));const qt=[{id:1,user:{user_img:"",user_username:"Ivan Ivanov"},product:"Set 20",text:"Отличный набор, всем понравилось!",stars:5,created:"2024-09-05"},{id:2,user:{user_img:"",user_username:"Petr Petrov"},product:"Set 15",text:"Хороший вкус, но хотелось бы больше.",stars:4,created:"2024-09-03"},{id:1,user:{user_img:"",user_username:"Ivan Ivanov"},product:"Set 20",text:"Отличный набор, всем понравилось!",stars:5,created:"2024-09-05"},{id:2,user:{user_img:"",user_username:"Petr Petrov"},product:"Set 15",text:"Хороший вкус, но хотелось бы больше.",stars:4,created:"2024-09-03"},{id:1,user:{user_img:"",user_username:"Ivan Ivanov"},product:"Set 20",text:"Отличный набор, всем понравилось!",stars:5,created:"2024-09-05"},{id:2,user:{user_img:"",user_username:"Petr Petrov"},product:"Set 15",text:"Хороший вкус, но хотелось бы больше.",stars:4,created:"2024-09-03"}],Gt=()=>{var i;const[e,a]=m.useState(!1),[s,r]=m.useState(qt);console.log(r);const[n,c]=m.useState(!1),{product:l}=R(u=>u.product),d=()=>{a(!0)};return t.jsxs("div",{className:"reviews-section",children:[t.jsx(X,{itemLayout:"horizontal",dataSource:(i=l==null?void 0:l.product_reviews)==null?void 0:i.slice(0,n?s.length:3),footer:t.jsx(E,{onClick:()=>c(u=>!u),children:n?"скрыть":"показать все"}),renderItem:u=>t.jsx(X.Item,{children:t.jsx(X.Item.Meta,{avatar:u.user_img?t.jsx(pe,{src:u.user_img}):t.jsx(pe,{icon:t.jsx(st,{})}),title:u.user_username,description:t.jsxs("div",{children:[t.jsx(Z,{disabled:!0,defaultValue:u.stars}),t.jsx("p",{children:u.text}),t.jsx("p",{className:"review-date",children:u.created?je(u.created):""})]})})})}),t.jsx(nt,{fallback:t.jsx(E,{style:{height:"40px",borderRadius:"10px"},type:"primary",onClick:d,children:"Войдите чтобы оставить отзыв"}),children:t.jsx(Kt,{})}),t.jsx(ot,{visible:e,onClose:()=>a(!1)}),t.jsx("br",{}),t.jsx("br",{})]})},Yt=()=>{const e=U(),{id:a}=Q(),{product:s}=R(n=>n.product),r=()=>{window.scrollTo({top:0,behavior:"smooth"})};return m.useEffect(()=>{r()},[]),m.useEffect(()=>{e(lt({filters:""})),e(Ce({id:Number(a)}))},[a]),t.jsxs("div",{className:"container",children:[t.jsx(it,{children:t.jsxs("title",{children:["Mnogosushi | ",s!=null&&s.title?s.title:"Детальный просмотр"]})}),t.jsx(Bt,{}),t.jsx(Gt,{})]})};export{Yt as default};
